// Do not edit directly!
// This file was generated by camel-quarkus-maven-plugin:update-extension-doc-page
[id="extensions-jolokia"]
= Jolokia
:linkattrs:
:cq-artifact-id: camel-quarkus-jolokia
:cq-native-supported: true
:cq-status: Stable
:cq-status-deprecation: Stable
:cq-description: Expose runtime metrics and management operations via JMX with Jolokia
:cq-deprecated: false
:cq-jvm-since: 3.19.0
:cq-native-since: 3.20.0

ifeval::[{doc-show-badges} == true]
[.badges]
[.badge-key]##JVM since##[.badge-supported]##3.19.0## [.badge-key]##Native since##[.badge-supported]##3.20.0##
endif::[]

Expose runtime metrics and management operations via JMX with Jolokia

[id="extensions-jolokia-maven-coordinates"]
== Maven coordinates

https://{link-quarkus-code-generator}/?extension-search=camel-quarkus-jolokia[Create a new project with this extension on {link-quarkus-code-generator}, window="_blank"]

Or add the coordinates to your existing project:

[source,xml]
----
<dependency>
    <groupId>org.apache.camel.quarkus</groupId>
    <artifactId>camel-quarkus-jolokia</artifactId>
</dependency>
----
ifeval::[{doc-show-user-guide-link} == true]
Check the xref:user-guide/index.adoc[User guide] for more information about writing Camel Quarkus applications.
endif::[]

[id="extensions-jolokia-usage"]
== Usage
This extension adds https://jolokia.org/[Jolokia] support to your application.

[id="extensions-jolokia-usage-jolokia-http-endpoints"]
=== Jolokia HTTP endpoints

In prod mode, Jolokia is accessible at the following URLs.

* http://0.0.0.0:8778/jolokia/
* http://0.0.0.0:8080/q/jolokia

In dev and test modes Jolokia is bound only to `localhost`.

To disable exposing Jolokia via the Quarkus management interface at `/q/jolokia`, add the following configuration to `application.properties`.

[source]
----
quarkus.camel.jolokia.register-management-endpoint=false
----

If you want to disable Jolokia entirely, then add the following configuration to `application.properties`.

[source]
----
quarkus.camel.jolokia.enabled=false
----

[id="extensions-jolokia-usage-jolokia-configuration"]
=== Jolokia configuration

Any of the https://jolokia.org/reference/html/manual/agents.html[Jolokia configuration options] can be configured via the `quarkus.camel.jolokia.additional-properties.<jolokia-property-name>` option.
Where `<jolokia-property-name>` is the name of the Jolokia configuration option you want to set.

For example, the following configuration added to `application.properties` enables Jolokia debugging and sets the max depth for traversing bean properties.

[source]
----
quarkus.camel.jolokia.additional-properties.debug=true
quarkus.camel.jolokia.additional-properties.maxDepth=10
----

[id="extensions-jolokia-usage-jolokia-restrictor"]
=== Jolokia restrictor

By default, a Jolokia restrictor is automatically registered that exposes access to only a specific set of MBean domains.

* `org.apache.camel`
* `java.lang`
* `java.nio`

If this is too restrictive, then you can either specify your own MBean domains, disable the default restrictor, or create a custom restrictor.

[id="extensions-jolokia-usage-default-restrictor-mbean-domains"]
==== Default restrictor MBean domains

You can modify the set of MBean domains referenced by the default restrictor by adding configuration like the following to `application.properties`.

[source]
----
quarkus.camel.jolokia.camel-restrictor-allowed-mbean-domains=org.apache.camel
----

[id="extensions-jolokia-usage-disabling-the-default-restrictor"]
==== Disabling the default restrictor

The following configuration added to `application.properties` disables the default restrictor.

[source]
----
quarkus.camel.jolokia.register-camel-restrictor=false
----

[id="extensions-jolokia-usage-create-a-custom-restrictor"]
==== Create a custom restrictor

You can create your own restrictor class and register it with Jolokia.

[source,java]
----
public class CustomRestrictor extends AllowAllRestrictor {
    // Override methods to apply custom restrictions
}
----

Register the restrictor with Jolokia by adding the following configuration to `application.properties`.

[source]
----
quarkus.camel.jolokia.additional-properties.restrictorClass=org.acme.CustomRestrictor
----

[id="extensions-jolokia-usage-kubernetes-openshift-support"]
=== Kubernetes & OpenShift support

[id="extensions-jolokia-usage-generated-kubernetes-manifests"]
==== Generated Kubernetes manifests

If the `quarkus-kubernetes` or `quarkus-openshift` extensions are present, a container port named `jolokia` will be added automatically to the pod configuration within the generated Kubernetes manifest resources.

This can be disabled by adding the following configuration to `application.properties`.

[source]
----
quarkus.camel.jolokia.kubernetes.expose-container-port=false
----

[id="extensions-jolokia-usage-automatic-enablement-of-ssl-client-authentication"]
==== Automatic enablement of SSL client authentication

If the application detects that it is running on Kubernetes or OpenShift, then Jolokia is automatically configured for SSL client authentication.
This is useful if you use tools like https://hawt.io/[Hawtio] to discover and connect to your running application pod.

This functionality can be disabled by adding the following configuration to `application.properties`.

[source]
----
quarkus.camel.jolokia.kubernetes.client-authentication-enabled=false
----

Note that if you choose to use https://github.com/hawtio/hawtio-online[hawtio-online] to connect to your running application, then you must configure the Jolokia client principal.

[source]
----
quarkus.camel.jolokia.kubernetes.client-principal=cn=hawtio-online.hawtio.svc
----


[id="extensions-jolokia-camel-quarkus-limitations"]
== Camel Quarkus limitations

[id="extensions-jolokia-limitations-native-mode-limitations"]
=== Native mode limitations

JMX in GraalVM is still *experimental*. Therefore, some features are not available in native mode.

Refer to the Camel Quarkus Management extension xref:reference/extensions/management.adoc#extensions-management-limitations-native-mode[limitations] section for more details.


[id="extensions-jolokia-additional-camel-quarkus-configuration"]
== Additional Camel Quarkus configuration

[width="100%",cols="80,5,15",options="header"]
|===
| Configuration property | Type | Default


a|icon:lock[title=Fixed at build time] [[quarkus-camel-jolokia-enabled]]`link:#quarkus-camel-jolokia-enabled[quarkus.camel.jolokia.enabled]`

Enables Jolokia support.
| `boolean`
| `true`

a|icon:lock[title=Fixed at build time] [[quarkus-camel-jolokia-path]]`link:#quarkus-camel-jolokia-path[quarkus.camel.jolokia.path]`

The context path that the Jolokia agent is deployed under.
| `string`
| `jolokia`

a|icon:lock[title=Fixed at build time] [[quarkus-camel-jolokia-register-management-endpoint]]`link:#quarkus-camel-jolokia-register-management-endpoint[quarkus.camel.jolokia.register-management-endpoint]`

Whether to register a Quarkus management endpoint for Jolokia (default `/q/jolokia`).
When enabled this activates a management endpoint which will be accessible on a path relative to
`${quarkus.http.non-application-root-path}/${quarkus.camel.jolokia.server.path}`.
If the management interface is enabled, the value will be resolved as a path relative to
`${quarkus.management.root-path}/${quarkus.camel.jolokia.server.path}`. Note that for this feature to work you must
have `quarkus-vertx-http` on the application classpath.
| `boolean`
| `true`

a|icon:lock[title=Fixed at build time] [[quarkus-camel-jolokia-camel-restrictor-allowed-mbean-domains]]`link:#quarkus-camel-jolokia-camel-restrictor-allowed-mbean-domains[quarkus.camel.jolokia.camel-restrictor-allowed-mbean-domains]`

Comma separated list of allowed MBean domains used by `CamelJolokiaRestrictor`.
| List of `string`
| `org.apache.camel,java.lang,java.nio`

a|icon:lock[title=Fixed at build time] [[quarkus-camel-jolokia-kubernetes-expose-container-port]]`link:#quarkus-camel-jolokia-kubernetes-expose-container-port[quarkus.camel.jolokia.kubernetes.expose-container-port]`

When {@code true} and the quarkus-kubernetes extension is present, a container port named jolokia will
be added to the generated Kubernetes manifests within the container spec ports definition.
| `boolean`
| `true`

a| [[quarkus-camel-jolokia-server-auto-start]]`link:#quarkus-camel-jolokia-server-auto-start[quarkus.camel.jolokia.server.auto-start]`

Whether the Jolokia agent HTTP server should be started automatically.
When set to `false`, it is the user responsibility to start the server.
This can be done via `@Inject CamelQuarkusJolokiaServer` and then invoking the `start()` method.
| `boolean`
| `true`

a| [[quarkus-camel-jolokia-server-host]]`link:#quarkus-camel-jolokia-server-host[quarkus.camel.jolokia.server.host]`

The host address to which the Jolokia agent HTTP server should bind to.
When unspecified, the default is localhost for dev and test mode.
In prod mode the default is to bind to all interfaces at 0.0.0.0.
| `string`
| 

a| [[quarkus-camel-jolokia-server-port]]`link:#quarkus-camel-jolokia-server-port[quarkus.camel.jolokia.server.port]`

The port on which the Jolokia agent HTTP server should listen on.
| `int`
| `8778`

a| [[quarkus-camel-jolokia-server-discovery-enabled-mode]]`link:#quarkus-camel-jolokia-server-discovery-enabled-mode[quarkus.camel.jolokia.server.discovery-enabled-mode]`

The mode in which Jolokia agent discovery is enabled. The default `dev-test`, enables discovery only in dev and
test modes.
A value of `all` enables agent discovery in dev, test and prod modes. Setting the value to `none` will
disable agent discovery in all modes.
| `all`, `dev-test`, `none`
| `dev-test`

a| [[quarkus-camel-jolokia-kubernetes-client-authentication-enabled]]`link:#quarkus-camel-jolokia-kubernetes-client-authentication-enabled[quarkus.camel.jolokia.kubernetes.client-authentication-enabled]`

Whether to enable Jolokia SSL client authentication in Kubernetes environments.
Useful for tools such as hawtio to be able to connect with your application.
| `boolean`
| `true`

a| [[quarkus-camel-jolokia-kubernetes-service-ca-cert]]`link:#quarkus-camel-jolokia-kubernetes-service-ca-cert[quarkus.camel.jolokia.kubernetes.service-ca-cert]`

Absolute path of the CA certificate Jolokia should use for SSL client authentication.
| link:https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html[`File`]
| `/var/run/secrets/kubernetes.io/serviceaccount/service-ca.crt`

a| [[quarkus-camel-jolokia-kubernetes-client-principal]]`link:#quarkus-camel-jolokia-kubernetes-client-principal[quarkus.camel.jolokia.kubernetes.client-principal]`

The principal which must be given in a client certificate to allow access to Jolokia.
| `string`
| 

a| [[quarkus-camel-jolokia-additional-properties-additional-properties]]`link:#quarkus-camel-jolokia-additional-properties-additional-properties[quarkus.camel.jolokia.additional-properties."additional-properties"]`

Arbitrary Jolokia configuration options. These are described at the
https://jolokia.org/reference/html/manual/agents.html[Jolokia documentation].
Options can be configured like `quarkus.camel.jolokia.additional-properties."debug"=true`.
| `Map<String,String>`
| 

a| [[quarkus-camel-jolokia-register-camel-restrictor]]`link:#quarkus-camel-jolokia-register-camel-restrictor[quarkus.camel.jolokia.register-camel-restrictor]`

When `true`, a Jolokia restrictor is registered that limits MBean read, write and operation execution to the
following MBean domains.

* org.apache.camel
* java.lang
* java.nio

Note that this option has no effect if `quarkus.camel.jolokia.additional-properties."restrictorClass"` is set.
| `boolean`
| `true`
|===

[.configuration-legend]
{doc-link-icon-lock}[title=Fixed at build time] Configuration property fixed at build time. All other configuration properties are overridable at runtime.

